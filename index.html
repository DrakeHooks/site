<!doctype html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>{{ title }}</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='site.css') }}">
  <script>
    // Theme init before paint
    (() => {
      const saved = localStorage.getItem("uploader_theme");
      const systemDark = window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches;
      const theme = saved || (systemDark ? "dark" : "light");
      document.documentElement.dataset.theme = theme;
    })();
  </script>
</head>

<body>
  <main class="wrap">
    <header class="top">
      <div class="brand">
        <div class="brand__title">upload.drakehooks.net</div>
        <div class="brand__sub">Archive uploaderr</div>
      </div>
<!-- TEST: live edit works -->
                <h1 style="color:red;">LIVE EDIT TEST</h1>

      <button class="toggle" type="button" id="themeToggle" aria-label="Toggle theme">
        <span class="toggle__dot" aria-hidden="true"></span>
        <span class="toggle__label">Dark</span>
      </button>
    </header>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <section class="flash">
          {% for category, msg in messages %}
            <div class="flash__item flash__item--{{ category }}">{{ msg }}</div>
          {% endfor %}
        </section>
      {% endif %}
    {% endwith %}

    <form class="card" method="post" action="{{ url_for('upload') }}" enctype="multipart/form-data">
      <div class="row">
        <label class="label" for="post_date">Date</label>
        <div class="dateRow">
          <input
            class="input"
            id="post_date"
            name="post_date"
            inputmode="numeric"
            autocomplete="off"
            placeholder="12 23 2025 or 2025-12-23"
            value="{{ default_date }}"
          />
          <label class="check">
            <input type="checkbox" id="no_date" />
            <span>No date</span>
          </label>
          <input type="hidden" name="no_date" id="no_date_hidden" value="0" />
        </div>
        <div class="hint">Default is today. You can change it, or pick “No date”.</div>
      </div>

      <div class="row">
        <label class="label" for="note">Optional note (becomes the text in index.md)</label>
        <textarea class="textarea" id="note" name="note" placeholder="Type anything…"></textarea>
      </div>

      <div class="row">
        <label class="label">Files</label>
        <div class="drop" id="drop">
          <input class="file" id="files" name="files" type="file" multiple />
          <div class="drop__text">
            <div class="drop__title">Tap or drag files</div>
            <div class="drop__sub" id="fileCount">No files selected</div>
          </div>
        </div>
      </div>

      <button class="btn" type="submit">Upload</button>
      <div class="foot">Tip: you can upload just text with no files.</div>
    </form>
  </main>

  <script src="{{ url_for('static', filename='site.js') }}"></script>
</body>
</html>