{{- $src := .Get "src" -}}
{{- $alt := .Get "alt" | default "" -}}

{{- $img := .Page.Resources.GetMatch $src -}}

{{- if not $img -}}
  {{- /* fallback for static/ images */ -}}
  <img src="{{ $src | relURL }}" alt="{{ $alt }}">
{{- else -}}
  {{- $avif := $img.Process "avif q60" -}}
  <picture>
    {{- if $avif -}}
      <source srcset="{{ $avif.RelPermalink }}" type="image/avif">
    {{- end -}}
    <img
      src="{{ $img.RelPermalink }}"
      alt="{{ $alt }}"
      loading="lazy"
      decoding="async"
    >
  </picture>
{{- end -}}
